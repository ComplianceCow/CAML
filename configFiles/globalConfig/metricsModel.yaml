metrics:
- metricID: AIS-06-M1
  primaryControlID: AIS-06
  relatedControlID:
    - DCS-06
    - GRC-05
  metricDescription: This metric measures the percentage of running production code that can be directly traced back to automated security and quality tests that verify the compliance of each build.
  measures:
  - measureName: prod_apps_with_verification
    measureAlias: A
    measureDescription: Total number of pieces of Production Code that have an Associated Verification Step
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName: prod_apps_deployed
    measureAlias: B
    measureDescription: Total number of pieces of Production Code
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  rules: ""Production Code"" is code deployed to the production runtime environment(s) within the scope of the Information Security Program defined in the CCMv4 GRC-05 control objective. An ""Associated Verification Step"" is a capability in the deployment process that ties production code back to a build with traceable results for quality, security, and privacy tests.
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 95%
    sloPeriod: 30d
  implementationGuidelines: There must be a Software Inventory of Deployed Production Code (DCS-06).  Production code must be quantified based on the definition of deployed code running in production (e.g. microservices, builds, releases, packages, libraries, serverless functions, etc.). This should be the same number used to measure AIS-07. The definition of ""deployed production code"" used for the software inventory should be aligned with application security scanning, testing, and/or reporting methods where possible to simplify measurement. The likelihood of standardized deployments can decrease as the number of different deployment systems increases. If the Software Deployment Pipeline has multiple stages where change could be introduced, and end-to-end validation cannot be performed, then the metric "Percentage of steps in the Software Deployment Pipeline that have an associated verification step" may be more suitable for an organization. There should be a mechanism to identify deviations, and if deviations from the standard are approved, then the system should account for (and manage) the exception as approved. This metric should at least be aligned with an organization's development or release cycle to provide timely input for correction in the next deployment or release. For example, if an organization uses an Agile development methodology with two-week sprints, then the metric should be measured at least every two weeks to provide data for review at sprint retros.
- metricID: AIS-07-M3
  measures:
  - measureName: prod_apps_deployed_with_acceptable_vuls
    measureAlias: A
    measureDescription: Number of deployed production applications with acceptable
      level of risk from application security vulnerabilities
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName: prod_apps_deployed
    measureAlias: B
    measureDescription: Total Number of deployed production applications
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 80%
    sloPeriod: 30d
- metricID: AIS-07-M6
  measures:
  - measureName: nc_vuln_remediation_in_prod_apps
    measureAlias: A
    measureDescription: Number of unaccepted critical or high vulnerabilities in production applications with an age greater than the policy defined maximum age
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName: risky_vulns_in_prod_apps
    measureAlias: B
    measureDescription: Total number of critical or high vulnerabilities in production applications within this period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin:
    sloPeriod: 30d
- metricID: BCR-06-M1
  measures:
  - measureName: bcr_tests_critical_systems
    measureAlias: A
    measureDescription: Number of critical systems that passed BCR tests during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 365d
  - measureName: critical_systems_count
    measureAlias: B
    measureDescription: Total number of critical systems operating during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 365d
  metricFormula: '(A/B)*100'
  metricPeriod: 365d
  metricFrequency: 365d
  metricCrontabExample: 0 0 1 1 *
  metricSLORecommendations:
  - sloRangeMin: 80%
    sloPeriod: 365
- metricID: CCC-03-M1
  measures:
  - measureName: assets_under_change_management
    measureAlias: A
    measureDescription: Number of assets that have change management technology integrated
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName: total_assets_count
    measureAlias: B
    measureDescription: Total number of assets
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 80%
    sloPeriod: 30d
- metricID: CCC-07-M1
  measures:
  - measureName: config_items_passing_tests
    measureAlias: A
    measureDescription: Number of configuration items that were tested and passed successfully
    measureUnit: count
    measureType: calculate
    measurePeriod: 7d
  - measureName: total_config_items
    measureAlias: B
    measureDescription: Total number of configuration items that were tested
    measureUnit: count
    measureType: calculate
    measurePeriod: 7d
  metricFormula: '(A/B)*100'
  metricPeriod: 7d
  metricFrequency: 7d
  metricCrontabExample: 0 0 * * 0
  metricSLORecommendations:
  - sloRangeMin: 95%
    sloPeriod: 30d
- metricID: CEK-03-M2
  measures:
  - measureName: acvp_approved_data_assets
    measureAlias: A
    measureDescription: Number of assets responsible for data at-rest or in-transit where the cryptographic library has passed Automated Cryptographic Validation Protocol tests or equivalent tests
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName: data_at_rest_in_transit_assets
    measureAlias: B
    measureDescription: Total number of assets responsible for data at-rest or in-transit
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 85%
    sloPeriod: 30d
- metricID: CEK-04-M1
  measures:
  - measureName: compliant_crypto_assets
    measureAlias: A
    measureDescription: Number of assets with a cryptographic function that meets cryptographic requirements
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName: total_crypto_assets
    measureAlias: B
    measureDescription: Total number of assets with a cryptographic function
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 90%
    sloPeriod: 30d
- metricID: DCS-06-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of distinct assets seen in security audit logs during the sampling period that are in an asset catalog
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Number of distinct assets seen in security audit logs during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '(A/B)*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 * * *
  metricSLORecommendations:
  - sloRangeMin: 95%
    sloPeriod: 1d
- metricID: DSP-04-M2
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Total number of data records classified by type and/or sensitivity
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of data records stored
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 30d
- metricID: DSP-04-M3
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Total number of assets in the asset catalog that are classified by type and/or sensitivity of the data on that asset
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of assets in the organization's asset catalog
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 30d
- metricID: DSP-05-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of data records or data stores from the CCMv4 DSP-03 inventory correctly included in the data flow documentation
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  - measureName:
    measureAlias: B
    measureDescription: Total number of data records or data stores in the CCMv4 DSP-03 inventory
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  metricFormula: '(A/B)*100'
  metricPeriod: 15d
  metricFrequency: 15d
  metricCrontabExample: 0 0 1,15 * *
  metricSLORecommendations:
  - sloRangeMin: 80%
    sloPeriod: 15d
- metricID: DSP-05-M2
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of data streams from the CCMv4 DSP-03 inventory correctly included in the data flow documentation
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  - measureName:
    measureAlias: B
    measureDescription: Total number of data streams in the CCMv4 DSP-03 inventory
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  metricFormula: '(A/B)*100'
  metricPeriod: 15d
  metricFrequency: 15d
  metricCrontabExample: 0 0 1,15 * *
  metricSLORecommendations:
  - sloRangeMin: 80%
    sloPeriod: 15d
- metricID: GRC-04-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of active policy exceptions where the time to resolution is within the documented timeline for resolution, during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of active policy exceptions, during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 90%
    sloPeriod: 30d
- metricID: IAM-07-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of terminated users deprovisioned within policy guidelines during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of terminated users during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 30d
- metricID: IAM-08-M2
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of accounts reviewed with correct access in the Last 90 Days
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of Accounts
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 95%
    sloPeriod: 30d
- metricID: IAM-09-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of users with admin access to more than one of the following capabilities; production data management, encryption and key management, or logging
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Number of users with access to production data management, encryption and key management, or logging capabilities
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '((1-(A/B))*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 * * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 1d
- metricID: IPY-03-M2
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Count of data flows that use an approved, standardized cryptographic security function
    measureUnit: count
    measureType: calculate
    measurePeriod: 1h
  - measureName:
    measureAlias: B
    measureDescription: Count of all data flows
    measureUnit: count
    measureType: calculate
    measurePeriod: 1h
  metricFormula: '(A/B)*100'
  metricPeriod: 1h
  metricFrequency: 1h
  metricCrontabExample: 0 * * * *
  metricSLORecommendations:
  - sloRangeMin: 99.99%
    sloPeriod: 1h
- metricID: IVS-04-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of production assets that are in compliance with hardening baseline
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Total number of production assets
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '(A/B)*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 * * *
  metricSLORecommendations:
  - sloRangeMin: 99.99%
    sloPeriod: 1d
- metricID: LOG-03-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of Log Sources with Security Alerts configured
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Total Number of Log Sources
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '(A/B)*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 * * *
  metricSLORecommendations:
  - sloRangeMin: 95%
    sloPeriod: 1d
- metricID: LOG-05-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of anomalies detected during the sampling period that were reviewed and resolved within a timeframe that is in compliance with Policy
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Total number of anomalies detected during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '(A/B)*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 * * *
  metricSLORecommendations:
  - sloRangeMin: 95%
    sloPeriod: 1d
- metricID: LOG-10-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of metrics reported in the CCMv4 CEK domain
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  - measureName:
    measureAlias: B
    measureDescription: Total number of controls in the CCMv4 CEK domain
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  metricFormula: '(A/B)*100'
  metricPeriod: 15d
  metricFrequency: 15d
  metricCrontabExample: 0 0 1,15 * *
  metricSLORecommendations:
  - sloRangeMin: 80%
    sloPeriod: 15d
- metricID: LOG-13-M2
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of minutes of uptime during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Duration of the sampling period in minutes
    measureUnit:
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '(A/B)*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 * * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 1d
- metricID: SEF-05-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of security events sourced from automated systems during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of security events that were recorded during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 90%
    sloPeriod: 30d
- metricID: SEF-06-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of security events triaged within policy defined time limit, during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 7d
  - measureName:
    measureAlias: B
    measureDescription: Total number of security events Logged, during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 7d
  metricFormula: '(A/B)*100'
  metricPeriod: 7d
  metricFrequency: 7d
  metricCrontabExample: 0 0 * * 0
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 7d
- metricID: SEF-06-M2
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Slope of the linear regression for triage times over the sampling period
    measureUnit:
    measureType: calculate
    measurePeriod: 30d
  metricFormula: 'A*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin:
    sloPeriod: 30d
- metricID: STA-07-M3
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Total number of third-party software components seen during the sampling period, which are from authorized providers
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  - measureName:
    measureAlias: B
    measureDescription: Total number of third-party software components seen during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 15d
  metricFormula: '(A/B)*100'
  metricPeriod: 15d
  metricFrequency: 15d
  metricCrontabExample: 0 0 1,15 * *
  metricSLORecommendations:
  - sloRangeMin: 99.9%
    sloPeriod: 15d
- metricID: STA-07-M5
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Total number of unique providers with observed connections
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Total Number of Unique Providers in the inventory
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '(A/B)*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 1,15 * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 1d
- metricID: TVM-03-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of high and critical vulnerabilities identified during the sampling period and remediated within policy timeframes
    measureUnit: count
    measureType: calculate
    measurePeriod: 7d
  - measureName:
    measureAlias: B
    measureDescription: Total Number of High and Critical Vulnerabilities identified during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 7d
  metricFormula: '(A/B)*100'
  metricPeriod: 7d
  metricFrequency: 7d
  metricCrontabExample: 0 0 * * 0
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 7d
- metricID: TVM-07-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of assets from the asset catalog scanned during the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of assets in the asset catalog
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 30d
- metricID: TVM-10-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of high and critical vulnerabilities identified for remediation within policy timeframes
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total Number of high and critical vulnerabilities identified or carried over into the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin:
    sloPeriod: 30d
- metricID: UEM-04-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of endpoints that exist in both the audit log and asset inventory
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: The total number of endpoints in the asset inventory
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 95%
    sloPeriod: 30d
- metricID: UEM-05-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Number of unique endpoints with suitable policy enforcement tools that reported compliance state within the sampling period
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  - measureName:
    measureAlias: B
    measureDescription: Total number of endpoints in the asset inventory
    measureUnit: count
    measureType: calculate
    measurePeriod: 1d
  metricFormula: '(A/B)*100'
  metricPeriod: 1d
  metricFrequency: 1d
  metricCrontabExample: 0 0 * * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 1d
- metricID: UEM-09-M1
  measures:
  - measureName:
    measureAlias: A
    measureDescription: Total number of managed endpoints for the workforce initiating observed connections that passed a device check inclusive (e.g. verifying malware protection)
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  - measureName:
    measureAlias: B
    measureDescription: Total number of managed endpoints for the workforce initiating observed connections
    measureUnit: count
    measureType: calculate
    measurePeriod: 30d
  metricFormula: '(A/B)*100'
  metricPeriod: 30d
  metricFrequency: 30d
  metricCrontabExample: 0 5 */1 * *
  metricSLORecommendations:
  - sloRangeMin: 99%
    sloPeriod: 30d
